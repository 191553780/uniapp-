{"version":3,"sources":["webpack:///D:/code/uni-app/嗅事app/pages/user-feedback/user-feedback.vue?7cf9","webpack:///D:/code/uni-app/嗅事app/pages/user-feedback/user-feedback.vue?32e1","webpack:///D:/code/uni-app/嗅事app/pages/user-feedback/user-feedback.vue?fd52","webpack:///D:/code/uni-app/嗅事app/pages/user-feedback/user-feedback.vue?bf33","webpack:///D:/code/uni-app/嗅事app/pages/user-feedback/user-feedback.vue"],"names":["data","scrollTop","style","contentHeight","itemHeight","list","page","loadtext","components","userChatBottom","userChatList","mounted","getData","initData","methods","res","uni","getSystemInfoSync","windowHeight","upx2px","e","pageToBottom","isFirst","q","createSelectorQuery","in","itemH","selectAll","$nextTick","fields","size","i","length","height","exec","url","$http","get","token","checkToken","err","errorCheck","arr","from_id","User","userinfo","id","to_id","isme","push","isMe","userpic","type","time","create_time","gstime","gettime","getChatTime","reverse","submit","post","now","Date","getTime","showToast","title"],"mappings":"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","file":"pages/user-feedback/user-feedback.js","sourcesContent":["import { render, staticRenderFns } from \"./user-feedback.vue?vue&type=template&id=2940340e&scoped=true&\"\nimport script from \"./user-feedback.vue?vue&type=script&lang=js&\"\nexport * from \"./user-feedback.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2940340e\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('2940340e', component.options)\n    } else {\n      api.reload('2940340e', component.options)\n    }\n    module.hot.accept(\"./user-feedback.vue?vue&type=template&id=2940340e&scoped=true&\", function () {\n      api.rerender('2940340e', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"D:/code/uni-app/嗅事app/pages/user-feedback/user-feedback.vue\"\nexport default component.exports","export * from \"-!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./user-feedback.vue?vue&type=template&id=2940340e&scoped=true&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import mod from \"-!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./user-feedback.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./user-feedback.vue?vue&type=script&lang=js&\"","//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n//\r\n\r\nimport userChatBottom from '@/components/user-chat/user-chat-bottom.vue'\r\nimport userChatList from '@/components/user-chat/user-chat-list.vue'\r\nimport time from '@/common/time.js'\r\n\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tscrollTop: 0,\r\n\t\t\tstyle: {\r\n\t\t\t\tcontentHeight: 0,\r\n\t\t\t\titemHeight: 0\r\n\t\t\t},\r\n\t\t\tlist: [],\r\n\t\t\tpage:1,\r\n\t\t\tloadtext:\"点击加载更多...\"\r\n\t\t};\r\n\t},\r\n\tcomponents: {\r\n\t\tuserChatBottom,\r\n\t\tuserChatList\r\n\t},\r\n\tmounted() {\r\n\t\tthis.getData()\r\n\t\tthis.initData()\r\n\t},\r\n\tmethods: {\r\n\t\t// 初始化参数\r\n\t\tinitData () {\r\n\t\t\ttry {\r\n\t\t\t\tconst res = uni.getSystemInfoSync();\r\n\t\t\t\tthis.style.contentHeight = res.windowHeight - uni.upx2px(120)\r\n\t\t\t} catch (e) {}\r\n\t\t},\r\n\t\tpageToBottom (isFirst = false) {\r\n\t\t\tlet q = uni.createSelectorQuery().in(this);\r\n\t\t\tlet itemH = q.selectAll('.user-chat-item');\r\n\t\t\tthis.$nextTick(() => {\r\n\t\t\t\titemH.fields({\r\n\t\t\t\t\tsize: true\r\n\t\t\t\t}, data => {\r\n\t\t\t\t\t// console.log(JSON.stringify(data));\r\n\t\t\t\t\tif (data) {\r\n\t\t\t\t\t\tif (isFirst) {\r\n\t\t\t\t\t\t\tfor (let i = 0;i < data.length; i++) {\r\n\t\t\t\t\t\t\t\tthis.style.itemHeight += data[i].height\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.style.itemHeight += data[data.length - 1].height\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.scrollTop = (this.style.itemHeight > this.style.contentHeight) ? this.style.itemHeight : 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t}).exec();\r\n\t\t\t})\r\n\t\t},\r\n\t\t// 获取用户反馈记录\r\n\t\tasync getData () {\r\n\t\t\tlet url = `/feedbacklist/${this.page}`;\r\n\t\t\tlet [err,res] = await this.$http.get(url,{},{\r\n\t\t\t\ttoken:true,\r\n\t\t\t\tcheckToken:true\r\n\t\t\t});\r\n\t\t\t// 错误处理\r\n\t\t\tif (!this.$http.errorCheck(err,res)) return;\r\n\t\t\t// 成功\r\n\t\t\tlet list = res.data.data.list;\r\n\t\t\tlet arr = [];\r\n\t\t\tfor (let i = 0; i < list.length; i++) {\r\n\t\t\t\tif (list[i].from_id == this.User.userinfo.id || list[i].to_id == this.User.userinfo.id) {\r\n\t\t\t\t\tlet isme = list[i].from_id == this.User.userinfo.id;\r\n\t\t\t\t\tarr.push({\r\n\t\t\t\t\t\tisMe: isme,\r\n\t\t\t\t\t\tuserpic: isme ? this.User.userinfo.userpic :\"../../static/demo/userpic/11.jpg\",\r\n\t\t\t\t\t\ttype:\"text\",\r\n\t\t\t\t\t\tdata:list[i].data,\r\n\t\t\t\t\t\ttime:list[i].create_time,\r\n\t\t\t\t\t\tgstime:time.gettime.getChatTime(list[i].create_time,i>0 ? list[i-1].create_time:0)\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.loadtext = list.length < 10 ? \"我是有底线的\" :\"点击加载更多\";\r\n\t\t\tarr.reverse()\r\n\t\t\tthis.list = [...arr,...this.list];\r\n\t\t\t// console.log(JSON.stringify(this.list))\r\n\t\t\tif (this.page === 1 && this.list.length>0) {\r\n\t\t\t\tthis.pageToBottom(true);\r\n\t\t\t} \r\n\t\t},\r\n\t\tasync submit (data) {\r\n\t\t\tlet [err,res] = await this.$http.post('/feedback',{\r\n\t\t\t\tdata:data\r\n\t\t\t},{ \r\n\t\t\t\ttoken:true,\r\n\t\t\t\tcheckToken:true\r\n\t\t\t});\r\n\t\t\t// 错误处理\r\n\t\t\tif (!this.$http.errorCheck(err,res)) return;\r\n\t\t\t// 成功处理\r\n\t\t\t// 构建数据\r\n\t\t\tlet now=new Date().getTime();\r\n\t\t\tlet gstime = time.gettime.getChatTime(now,this.list.length>0 ? this.list[this.list.length-1].time : 0);\r\n\t\t\tthis.list.push({\r\n\t\t\t\tisMe:true,\r\n\t\t\t\tuserpic:this.User.userinfo.userpic,\r\n\t\t\t\ttype:\"text\",\r\n\t\t\t\tdata:data,\r\n\t\t\t\ttime:now,\r\n\t\t\t\tgstime:gstime\r\n\t\t\t});\r\n\t\t\tthis.pageToBottom();\r\n\t\t\tuni.showToast({ title: '反馈成功' });\r\n\t\t}\r\n\t}\r\n}\r\n"],"sourceRoot":""}